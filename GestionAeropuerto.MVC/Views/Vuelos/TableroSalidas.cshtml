@model IEnumerable<GestionAeropuerto.MVC.Models.VueloViewModel>

@{
    ViewBag.Title = "Tablero de Salidas";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    body {
        background-color: #1a1a2e;
        color: #fff;
    }

    .tablero-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 20px;
        text-align: center;
        margin-bottom: 30px;
        border-radius: 10px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    }

        .tablero-header h1 {
            color: white;
            font-size: 2.5em;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        .tablero-header .hora {
            font-size: 1.5em;
            margin-top: 10px;
            color: #f0f0f0;
        }

    .vuelo-card {
        background: linear-gradient(135deg, #2d3561 0%, #1f2347 100%);
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 20px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        transition: all 0.3s ease;
        border-left: 5px solid #667eea;
    }

        .vuelo-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
        }

    .vuelo-numero {
        font-size: 2em;
        font-weight: bold;
        color: #667eea;
        margin-bottom: 10px;
    }

    .vuelo-ruta {
        font-size: 1.5em;
        margin: 15px 0;
    }

    .ciudad {
        font-weight: bold;
        color: #fff;
    }

    .flecha {
        color: #667eea;
        margin: 0 15px;
    }

    .vuelo-info {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
        padding-top: 15px;
        border-top: 1px solid rgba(255,255,255,0.1);
    }

    .info-item {
        text-align: center;
    }

    .info-label {
        color: #888;
        font-size: 0.9em;
        text-transform: uppercase;
    }

    .info-value {
        font-size: 1.3em;
        font-weight: bold;
        margin-top: 5px;
    }

    .estado-badge {
        padding: 8px 20px;
        border-radius: 20px;
        font-weight: bold;
        font-size: 1.1em;
        display: inline-block;
    }

    .estado-programado {
        background-color: #3498db;
        color: white;
    }

    .estado-abordando {
        background-color: #f39c12;
        color: white;
        animation: pulse 2s infinite;
    }

    .estado-vuelo {
        background-color: #27ae60;
        color: white;
    }

    .estado-retrasado {
        background-color: #e74c3c;
        color: white;
    }

    .estado-cancelado {
        background-color: #95a5a6;
        color: white;
    }

    @@keyframes pulse {
        0%, 100% {
            opacity: 1;
        }

        50% {
            opacity: 0.6;
        }
    }

    .puerta-grande {
        font-size: 2em;
        color: #667eea;
        font-weight: bold;
    }
</style>

<div class="container-fluid">
    <div class="tablero-header">
        <h1><i class="glyphicon glyphicon-plane"></i> TABLERO DE SALIDAS</h1>
        <div class="hora" id="reloj"></div>
    </div>

    @if (ViewBag.Error != null)
    {
        <div class="alert alert-danger">
            <strong>Error:</strong> @ViewBag.Error
        </div>
    }

    <div class="row">
        <div class="col-md-12 text-right mb-3">
            <a href="@Url.Action("Index")" class="btn btn-default btn-lg">
                <i class="glyphicon glyphicon-arrow-left"></i> Volver
            </a>
        </div>
    </div>

    @if (Model != null && Model.Any())
    {
        foreach (var vuelo in Model.OrderBy(v => v.FechaSalida))
        {
            <div class="vuelo-card">
                <div class="row">
                    <div class="col-md-8">
                        <div class="vuelo-numero">
                            @vuelo.NumeroVuelo
                            <small style="font-size: 0.5em; color: #888;">@vuelo.NombreAerolinea</small>
                        </div>

                        <div class="vuelo-ruta">
                            <span class="ciudad">@vuelo.Origen.Split('(')[0].Trim()</span>
                            <span class="flecha">✈</span>
                            <span class="ciudad">@vuelo.Destino.Split('(')[0].Trim()</span>
                        </div>

                        <div class="vuelo-info">
                            <div class="info-item">
                                <div class="info-label">Salida</div>
                                <div class="info-value">@vuelo.FechaSalida.ToString("HH:mm")</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Llegada</div>
                                <div class="info-value">@vuelo.FechaLlegada.ToString("HH:mm")</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Aeronave</div>
                                <div class="info-value" style="font-size: 1em;">@vuelo.ModeloAeronave</div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4 text-center" style="border-left: 1px solid rgba(255,255,255,0.1);">
                        <div style="margin-top: 20px;">
                            <div class="info-label">PUERTA</div>
                            @if (!string.IsNullOrEmpty(vuelo.NumeroPuerta))
                            {
                                <div class="puerta-grande">@vuelo.NumeroPuerta</div>
                            }
                            else
                            {
                                <div style="color: #888; margin-top: 10px;">Por asignar</div>
                            }
                        </div>

                        <div style="margin-top: 30px;">
                            @switch (vuelo.Estado)
                            {
                                case "Programado":
                                    <span class="estado-badge estado-programado">A TIEMPO</span>
                                    break;
                                case "Abordando":
                                    <span class="estado-badge estado-abordando">ABORDANDO</span>
                                    break;
                                case "En Vuelo":
                                    <span class="estado-badge estado-vuelo">DESPEGÓ</span>
                                    break;
                                case "Retrasado":
                                    <span class="estado-badge estado-retrasado">RETRASADO</span>
                                    break;
                                case "Cancelado":
                                    <span class="estado-badge estado-cancelado">CANCELADO</span>
                                    break;
                                default:
                                    <span class="estado-badge estado-programado">@vuelo.Estado.ToUpper()</span>
                                    break;
                            }
                        </div>

                        <div style="margin-top: 20px;">
                            <div class="info-label">Asientos Disponibles</div>
                            <div class="info-value" style="color: @(vuelo.AsientosDisponibles > 10 ? "#27ae60" : vuelo.AsientosDisponibles > 0 ? "#f39c12" : "#e74c3c");">
                                @vuelo.AsientosDisponibles
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
    }
    else
    {
        <div class="alert alert-info text-center" style="font-size: 1.5em; padding: 50px;">
            <i class="glyphicon glyphicon-info-sign"></i>
            No hay vuelos programados para hoy
        </div>
    }
</div>

@section Scripts {
    <script>
        function actualizarReloj() {
            var ahora = new Date();
            var opciones = {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            };
            document.getElementById('reloj').textContent = ahora.toLocaleDateString('es-ES', opciones);
        }

        actualizarReloj();
        setInterval(actualizarReloj, 1000);

        // Auto-refresh cada 30 segundos
        setTimeout(function() {
            location.reload();
        }, 30000);
    </script>
}